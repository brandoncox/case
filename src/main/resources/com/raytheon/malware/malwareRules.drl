package com.raytheon.malware;
import org.kie.api.runtime.process.WorkflowProcessInstance;
import java.util.Map;

rule "found a String1"
    ruleflow-group "malware-rules"
    dialect "mvel"
    
    when
        s: String (this == "STATIC")
        $process : WorkflowProcessInstance( )
    then
        System.out.println("the path will be static");
        WorkflowProcessInstance $p = (WorkflowProcessInstance)kcontext.getKieRuntime().getProcessInstance($process.getId()); //casting to WorkflowProcessInstance is essential
        $p.setVariable( "PATH","STATIC" );
        retract($process);
end

rule "found a String2"
    ruleflow-group "malware-rules"
    dialect "mvel"
    
    when
        s: String (this == "DYNAMIC")
        $process : WorkflowProcessInstance( )
    then
        System.out.println("the path will be dynamic");
        WorkflowProcessInstance $p = (WorkflowProcessInstance)kcontext.getKieRuntime().getProcessInstance($process.getId()); //casting to WorkflowProcessInstance is essential
        $p.setVariable( "PATH","DYNAMIC" );
        retract($process);
end