package com.raytheon.malware;

rule "determine path dynamic"
    ruleflow-group "malware-rules"
    dialect "mvel"
    
    when
        $obj1 :Map(this["analysisType"] == "DYNAMIC")
        $process : WorkflowProcessInstance( )
    then
        WorkflowProcessInstance $p = (WorkflowProcessInstance)kcontext.getKieRuntime().getProcessInstance($process.getId()); //casting to WorkflowProcessInstance is essential
        $p.setVariable( "PATH","DYNAMIC" );
        retract($process);
end

rule "determine path static"
    ruleflow-group "malware-rules"
    dialect "mvel"
    
    when
        $obj1 :Map(this["analysisType"] == "STATIC")
        $process : WorkflowProcessInstance( )
    then
        WorkflowProcessInstance $p = (WorkflowProcessInstance)kcontext.getKieRuntime().getProcessInstance($process.getId()); //casting to WorkflowProcessInstance is essential
        $p.setVariable( "PATH","STATIC" );
        retract($process);
end
